//TODO there will be a lot of db calls here
